### 1.文件下载

```js

export function exportfileApi(params) {
  return req.post('/api/predict/ssActivity/effectExport', params, { responseType: 'arraybuffer' })
}
// api 请求要设置 responseType:'arraybuffer' ，否则导出的文件无法打开
async exportFile() {
      if (this.loadingFile) return
      this.loadingFile = true
      const res = await exportfileApi({ id: this.selectid })
      this.loadingFile = false
      const link = document.createElement('a')
      const blob = new Blob([res], {
        type:
          'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet',
      })
      link.style.display = 'none'
      link.href = URL.createObjectURL(blob)
      link.setAttribute('download', '活动预测分析.xlsx')
      document.body.appendChild(link)
      link.click()
      document.body.removeChild(link)
 },
```

### 2.json 转 序列化 url

```javascript
export function jsonToUrlParams(obj, prefix) {
  const str = [];

  for (const key in obj) {
    if (obj.hasOwnProperty(key)) {
      const val = obj[key];
      const newPrefix = prefix ? `${prefix}[${key}]` : key;
      if (Array.isArray(val)) {
        str.push(...jsonToUrlParams(val, newPrefix));
      } else if (typeof val === 'object') {
        str.push(...jsonToUrlParams(val, newPrefix));
      } else {
        str.push(`${newPrefix}=${encodeURIComponent(val)}`);
      }
    }
  }

  return str.join('&');
}
```

### 3.下载

```javascript
const downloadFunc = (url) => {
   const aElem = document.createElement('a')
   aElem.setAttribute('href', url)
   aElem.setAttribute('download', 'download')
   aElem.click()
   aElem.remove()
}
```



